{"version":3,"sources":["lib/create-store.js","lib/middleware.js","lib/store.js","lib/view.js","components/filter-table/filter-table.js","components/file-list/file-list.js","data/files.json","index.js"],"names":["createStore","reducer","initialState","middleware","applyMiddleware","store","dispatchWithMiddleware","getState","dispatch","Object","assign","Error","subscribers","state","isDispatching","action","type","map","listener","subscribe","push","filter","l","module","exports","require","initState","files","actionTypes","freeze","SET_FILTER","SET_FILES","payload","setFilter","value","setFiles","View","el","_el","_store","_unsubscribe","_prepareRender","bind","prototype","innerHTML","render","destroy","debounce","fn","timeout","id","args","clearTimeout","setTimeout","FilterTable","_onInput","addEventListener","event","target","removeEventListener","FileList","querySelector","renderFiles","name","includes","hash","message","committer","time","slice","join","document","fileList","fetchFiles","filesMock","Promise","resolve","then"],"mappings":"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","file":"index.js","sourceRoot":"../src","sourcesContent":["function createStore(reducer, initialState, middleware) {\n  if (typeof middleware === 'function') {\n    return applyMiddleware(middleware);\n  }\n\n  function applyMiddleware(middleware) {\n    const store = createStore(reducer, initialState);\n    const dispatchWithMiddleware = middleware({\n      getState: store.getState,\n      dispatch: store.dispatch,\n    });\n    return Object.assign({}, store, {\n      dispatch: dispatchWithMiddleware,\n    });\n  }\n\n  if (typeof reducer !== 'function') {\n    throw new Error('Reducer must be a function');\n  }\n\n  const subscribers = [];\n  let state = initialState;\n  let isDispatching = false;\n\n  function dispatch(action) {\n    if (isDispatching) {\n      throw new Error('Reducer may not dispatch actions');\n    }\n\n    if (!action || typeof action !== 'object') {\n      throw new Error('Action must be an object');\n    }\n\n    if (typeof action.type === 'undefined') {\n      throw new Error('Action must have a \"type\" property');\n    }\n\n    try {\n      isDispatching = true;\n      state = reducer(state, action);\n    } finally {\n      isDispatching = false;\n    }\n\n    subscribers.map(listener => listener());\n  }\n\n  function subscribe(listener) {\n    if (typeof listener !== 'function') {\n      throw new Error('Listener must be a function');\n    }\n\n    subscribers.push(listener);\n\n    return function() {\n      subscribers = subscribers.filter(l => l !== listener);\n    };\n  }\n\n  function getState() {\n    return state;\n  }\n\n  const store = {\n    dispatch,\n    subscribe,\n    getState,\n  };\n  return store;\n}\n\nmodule.exports =createStore;\n","function middleware({ getState, dispatch }) {\n  return function(action) {\n    if (typeof action === 'function') {\n      return action(dispatch, getState)\n    }\n    return dispatch(action);\n  }\n}\n\nmodule.exports = middleware;","const createStore = require('./create-store');\nconst middleware = require('./middleware');\n\nconst initState = {\n  filter: '',\n  files: [],\n};\n\nconst actionTypes = Object.freeze({\n  SET_FILTER: 'setFilter',\n  SET_FILES: 'setFiles',\n});\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case actionTypes.SET_FILTER:\n      return {\n        ...state,\n        filter: action.payload,\n      };\n    case actionTypes.SET_FILES:\n      return {\n        ...state,\n        files: action.payload,\n      };\n    default:\n      return state;\n  }\n}\n\nmodule.exports.store = createStore(reducer, initState, middleware);\n\nmodule.exports.setFilter = function(value) {\n  return {\n    type: actionTypes.SET_FILTER,\n    payload: value,\n  };\n};\n\nmodule.exports.setFiles = function(value) {\n  return {\n    type: actionTypes.SET_FILES,\n    payload: value,\n  };\n};\n","function View(el, store) {\n  this._el = el;\n  this._store = store;\n  this._unsubscribe = store.subscribe(\n    this._prepareRender.bind(this)\n  );\n  this._prepareRender();\n}\n\nView.prototype._prepareRender = function() {\n  this._el.innerHTML = this.render(this._store.getState());\n}\n\nView.prototype.render = function() {\n  throw new Error('Render should be overridden');\n}\n\nView.prototype.destroy = function() {\n  this._el.innerHTML = '';\n  this._unsubscribe();\n}\n\nmodule.exports = View;","const { setFilter } = require('../../lib/store');\nconst View = require('../../lib/view');\n\nfunction debounce(fn, timeout = 500) {\n  let id;\n  return (...args) => {\n    clearTimeout(id);\n    id = setTimeout(() => fn(...args), timeout)\n  }\n}\n\nclass FilterTable extends View {\n  constructor(el, store) {\n    super(el, store);\n    this._onInput = this._onInput.bind(this);\n    this._el.addEventListener('change', this._onInput);\n    // this._el.addEventListener('keydown', debounce(this._onInput));\n  }\n\n  _onInput(event) {\n    this._store.dispatch(setFilter(event.target.value));\n    // document.querySelector('.FilterTable-Input').focus();\n  }\n\n  render({ filter }) {\n    return `<input class=\"FilterTable-Input\" value=\"${filter}\" type=\"search\" />`;\n  }\n\n  destroy() {\n    super.destroy();\n    this._el.removeEventListener('change', this._onInput);\n  }\n}\n\nmodule.exports = FilterTable;","const View = require('../../lib/view');\n\nclass FileList extends View {\n  constructor(el, store) {\n    super(el.querySelector('tbody'), store);\n  }\n\n  render({filter, files}) {\n    let renderFiles = files;\n    if (filter) {\n      renderFiles = files.filter(({ name }) => name.includes(filter));\n    }\n    return renderFiles.map(({type, name, hash, message, committer, time}) => `\n    <tr class=\"Table-Line Divider\">\n      <td class=\"Table-Col\">\n        <span class=\"FileTypeIcon FileTypeIcon_type_${type}\">\n          ${name}\n        </span>\n      </td>\n      <td class=\"Table-Col\">\n        <a href=\"#\" class=\"CommitHash Link\">${hash}</a>\n      </td>\n      <td class=\"Table-Col\">\n        ${message}\n      </td>\n      <td class=\"Table-Col\">\n        <span class=\"Committer\">\n          <span class=\"Committer-FirstLetter\">\n          ${committer[0]}</span>${committer.slice(1)}\n        </span>\n      </td>\n      <td class=\"Table-LastCol\">\n        ${time}\n      </td>\n    </tr>\n  `).join('');\n  }\n}\n\nmodule.exports = FileList;","module.exports = {\n  \"path\": [],\n  \"filename\": \"arcadia\",\n  \"committer\": \"robot-srch-releaser\",\n  \"fileTabs\": {\n    \"tabs\": [\"Files\", \"Branches\"],\n    \"activeTab\": \"Files\"\n  },\n  \"files\": [\n    {\n      \"type\": \"dir\",\n      \"name\": \"api\",\n      \"hash\": \"d53dsv\",\n      \"message\": \"[vcs] move http to arc\",\n      \"committer\": \"noxoomo\",\n      \"time\": \"4 s ago\"\n    },\n    {\n      \"type\": \"dir\",\n      \"name\": \"ci\",\n      \"hash\": \"d53dsv\",\n      \"message\": \"ARCADIA-771: append /trunk/arcadia/\",\n      \"committer\": \"annaveronika\",\n      \"time\": \"Yesterday, 14:50\"\n    },\n    {\n      \"type\": \"dir\",\n      \"name\": \"contrib\",\n      \"hash\": \"d53dsv\",\n      \"message\": \"[vcs] move http to arc\",\n      \"committer\": \"noxoomo\",\n      \"time\": \"4 s ago\"\n    },\n    {\n      \"type\": \"file\",\n      \"name\": \"ya.make\",\n      \"hash\": \"d53dsv\",\n      \"message\": \"[vcs] move http to arc\",\n      \"committer\": \"noxoomo\",\n      \"time\": \"4 s ago\"\n    }\n  ]\n}\n;","const { store, setFiles } = require('./lib/store');\nconst FilterTable = require('./components/filter-table/filter-table');\nconst FileList = require('./components/file-list/file-list');\n\nconst el = document.querySelector('.FilterTable');\nconst filter = new FilterTable(el, store);\n\nconst fileList = document.querySelector('.FileList');\nnew FileList(fileList, store);\n\nfunction fetchFiles() {\n  const filesMock = require('./data/files.json').files;\n  return new Promise(resolve => setTimeout(() => resolve(filesMock), 2000));\n}\n\nstore.dispatch(dispatch =>\n  fetchFiles().then(files => dispatch(setFiles(files)))\n);\n"]}